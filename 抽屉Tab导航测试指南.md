# 抽屉Tab导航测试指南

## 🚀 快速开始

### 1. 启动项目

在微信开发者工具中打开项目，进入拼图编辑页面。

### 2. 初始状态检查

✅ **检查项**：
- [ ] 底部抽屉处于收起状态（高度60px）
- [ ] 显示5个Tab标签：海报、模版、拼接、自由、设置
- [ ] 当前选中"模版"Tab（蓝色下划线）
- [ ] 悬浮添加图片按钮在右下角可见
- [ ] 画布在中央显示

---

## 📋 功能测试清单

### 测试1：Tab切换

#### 步骤：
1. 点击"海报"Tab
2. 点击"拼接"Tab
3. 点击"自由"Tab
4. 点击"设置"Tab
5. 点击"模版"Tab

#### 预期结果：
- [ ] 点击后Tab下方出现蓝色下划线
- [ ] 抽屉自动展开到半展开状态（300px）
- [ ] 显示对应Tab的内容
- [ ] 出现收起按钮（右上角）

#### 实际结果：
```
记录测试结果...
```

---

### 测试2：抽屉展开/收起

#### 步骤：
1. 点击任意Tab，抽屉展开
2. 点击右上角收起按钮
3. 再次点击Tab

#### 预期结果：
- [ ] 点击收起按钮后，抽屉收起到60px
- [ ] 收起按钮消失
- [ ] 再次点击Tab，抽屉重新展开
- [ ] 画布尺寸随抽屉状态自动调整

#### 实际结果：
```
记录测试结果...
```

---

### 测试3：拖动手势

#### 步骤：
1. 在Tab标签栏区域向上拖动
2. 拖动到中间位置松手
3. 再次向上拖动到顶部
4. 向下拖动到底部

#### 预期结果：
- [ ] 抽屉跟随手指移动
- [ ] 松手后自动吸附到最近的状态
- [ ] 拖动到中间松手 → 吸附到半展开（300px）
- [ ] 拖动到顶部松手 → 吸附到全展开（70%屏幕高度）
- [ ] 拖动到底部松手 → 吸附到收起（60px）

#### 实际结果：
```
记录测试结果...
```

---

### 测试4：画布自适应

#### 步骤：
1. 选择一个布局模板
2. 添加几张图片
3. 展开抽屉到半展开状态
4. 展开抽屉到全展开状态
5. 收起抽屉

#### 预期结果：
- [ ] 抽屉展开时，画布自动缩小
- [ ] 抽屉收起时，画布自动放大
- [ ] 画布比例保持不变（如1:1、16:9等）
- [ ] 图片内容正确重绘，无变形
- [ ] 画布始终在可见区域内

#### 实际结果：
```
记录测试结果...
```

---

### 测试5：悬浮按钮动态定位

#### 步骤：
1. 观察悬浮添加图片按钮的初始位置
2. 展开抽屉到半展开状态
3. 展开抽屉到全展开状态
4. 收起抽屉

#### 预期结果：
- [ ] 按钮始终在抽屉上方20px处
- [ ] 抽屉展开时，按钮向上移动
- [ ] 抽屉收起时，按钮向下移动
- [ ] 位置变化有平滑过渡动画
- [ ] 按钮始终可见，不被遮挡

#### 实际结果：
```
记录测试结果...
```

---

### 测试6：Tab内容显示

#### 步骤：
1. 切换到"模版"Tab
2. 切换到"设置"Tab
3. 切换到"海报"Tab
4. 切换到"拼接"Tab
5. 切换到"自由"Tab

#### 预期结果：

**模版Tab**：
- [ ] 显示"画布比例"横向滚动列表
- [ ] 显示"推荐布局"横向滚动列表
- [ ] 可以点击选择不同的画布比例
- [ ] 可以点击选择不同的布局模板

**设置Tab**：
- [ ] 显示"图片显示"开关（填满/完全显示）
- [ ] 显示"间距"滑块
- [ ] 显示"圆角"滑块
- [ ] 显示"背景"颜色选择器

**海报/拼接/自由Tab**：
- [ ] 显示占位文字（待接入数据）
- [ ] 占位内容居中显示
- [ ] 背景为白色卡片

#### 实际结果：
```
记录测试结果...
```

---

### 测试7：边界情况

#### 步骤：
1. 快速连续点击不同Tab
2. 快速拖动抽屉上下移动
3. 在拖动过程中点击Tab
4. 在抽屉动画过程中点击收起按钮

#### 预期结果：
- [ ] 无卡顿或闪烁
- [ ] 状态切换正确
- [ ] 无JavaScript错误
- [ ] 画布重绘正常

#### 实际结果：
```
记录测试结果...
```

---

### 测试8：不同屏幕尺寸

#### 步骤：
1. 在模拟器中测试不同设备
   - iPhone 6/7/8 (375x667)
   - iPhone 6/7/8 Plus (414x736)
   - iPhone X (375x812)
   - iPad (768x1024)

#### 预期结果：
- [ ] 抽屉在所有设备上正常显示
- [ ] 全展开高度为屏幕高度的70%
- [ ] 画布自适应不同屏幕尺寸
- [ ] 悬浮按钮位置正确

#### 实际结果：
```
记录测试结果...
```

---

## 🐛 常见问题排查

### 问题1：抽屉无法拖动

**可能原因**：
- 触摸事件未正确绑定
- `windowHeight` 未初始化

**排查步骤**：
1. 检查控制台是否有错误
2. 检查 `onLoad` 方法中是否正确获取 `windowHeight`
3. 检查 `onDrawerTouchStart/Move/End` 方法是否正确绑定

### 问题2：画布未自动调整

**可能原因**：
- `updateCanvasSizeForDrawer` 方法未调用
- Canvas未正确初始化

**排查步骤**：
1. 检查控制台日志："更新画布尺寸，当前抽屉高度: xxx"
2. 检查 `_canvas` 和 `_ctx` 是否已初始化
3. 检查 `aspectRatio` 和 `aspectRatios` 数据是否正确

### 问题3：悬浮按钮位置不对

**可能原因**：
- 内联样式未正确设置
- `drawerHeight` 数据未更新

**排查步骤**：
1. 检查元素的 `style` 属性是否包含 `bottom: xxxpx`
2. 检查 `drawerHeight` 的值是否正确
3. 检查CSS中是否有冲突的 `bottom` 属性

### 问题4：Tab切换无反应

**可能原因**：
- `onTabChange` 方法未正确绑定
- `currentTab` 数据未更新

**排查步骤**：
1. 检查控制台日志："切换到Tab: xxx"
2. 检查 `data-tab-id` 是否正确设置
3. 检查 `bindtap="onTabChange"` 是否正确绑定

---

## 📊 测试报告模板

### 测试环境
- **测试日期**：2025-11-06
- **测试工具**：微信开发者工具 v1.x.x
- **测试设备**：iPhone 模拟器
- **基础库版本**：2.19.4

### 测试结果汇总

| 测试项 | 状态 | 备注 |
|--------|------|------|
| Tab切换 | ✅ / ❌ |  |
| 抽屉展开/收起 | ✅ / ❌ |  |
| 拖动手势 | ✅ / ❌ |  |
| 画布自适应 | ✅ / ❌ |  |
| 悬浮按钮定位 | ✅ / ❌ |  |
| Tab内容显示 | ✅ / ❌ |  |
| 边界情况 | ✅ / ❌ |  |
| 不同屏幕尺寸 | ✅ / ❌ |  |

### 发现的问题

1. **问题描述**：
   - 严重程度：高 / 中 / 低
   - 复现步骤：
   - 预期结果：
   - 实际结果：

2. **问题描述**：
   - 严重程度：高 / 中 / 低
   - 复现步骤：
   - 预期结果：
   - 实际结果：

### 优化建议

1. 
2. 
3. 

---

## 🎯 验收标准

### 必须通过的测试项（P0）

- [ ] Tab可以正常切换
- [ ] 抽屉可以展开和收起
- [ ] 拖动手势正常工作
- [ ] 画布随抽屉自动调整尺寸
- [ ] 无JavaScript错误

### 重要测试项（P1）

- [ ] 悬浮按钮位置正确
- [ ] Tab内容正确显示
- [ ] 自动吸附功能正常
- [ ] 画布比例保持不变

### 可选测试项（P2）

- [ ] 动画流畅
- [ ] 不同屏幕尺寸适配
- [ ] 边界情况处理

---

## 📝 测试完成后

### 1. 提交测试报告
将测试结果记录在上方的测试报告模板中。

### 2. 修复问题
根据发现的问题进行修复。

### 3. 回归测试
修复后重新测试相关功能。

### 4. 发布上线
所有P0和P1测试项通过后，可以发布上线。

---

**版本**: v1.0.0  
**更新日期**: 2025-11-06  
**测试负责人**: ___________

