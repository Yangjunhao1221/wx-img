# åº•éƒ¨æŠ½å±‰Tabå¯¼èˆªç³»ç»Ÿè¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

åœ¨æ‹¼å›¾ç¼–è¾‘é¡µé¢å®ç°äº†ä¸€ä¸ª**åº•éƒ¨æŠ½å±‰å¼Tabå¯¼èˆªç³»ç»Ÿ**ï¼Œé‡‡ç”¨è‹¹æœå®˜ç½‘çš„ç®€çº¦è®¾è®¡é£æ ¼ï¼Œæä¾›æµç•…çš„äº¤äº’ä½“éªŒã€‚

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. äº”ä¸ªTabæ ‡ç­¾

| Tab ID | åç§° | åŠŸèƒ½è¯´æ˜ | çŠ¶æ€ |
|--------|------|----------|------|
| `poster` | æµ·æŠ¥ | æµ·æŠ¥æ¨¡ç‰ˆé€‰æ‹©ï¼ˆå¾…æ¥å…¥æ•°æ®ï¼‰ | å ä½ |
| `template` | æ¨¡ç‰ˆ | ç”»å¸ƒæ¯”ä¾‹é€‰æ‹© + æ¨èå¸ƒå±€ | âœ… å·²å®ç° |
| `splice` | æ‹¼æ¥ | æ‹¼æ¥æ¨¡å¼ï¼ˆå¾…æ¥å…¥æ•°æ®ï¼‰ | å ä½ |
| `free` | è‡ªç”± | è‡ªç”±æ¨¡å¼ï¼ˆå¾…æ¥å…¥æ•°æ®ï¼‰ | å ä½ |
| `settings` | è®¾ç½® | æ ·å¼è®¾ç½®ï¼ˆé—´è·ã€åœ†è§’ã€èƒŒæ™¯è‰²ç­‰ï¼‰ | âœ… å·²å®ç° |

### 2. ä¸‰å±‚æŠ½å±‰çŠ¶æ€

| çŠ¶æ€ | é«˜åº¦ | è¯´æ˜ | è§¦å‘æ–¹å¼ |
|------|------|------|----------|
| **æ”¶èµ·** (collapsed) | 60px | åªæ˜¾ç¤ºTabæ ‡ç­¾æ  | ç‚¹å‡»æ”¶èµ·æŒ‰é’® / å‘ä¸‹æ‹–åŠ¨ |
| **åŠå±•å¼€** (half) | 300px | æ˜¾ç¤ºä¸»è¦å†…å®¹ | ç‚¹å‡»Tab / å‘ä¸Šæ‹–åŠ¨ |
| **å…¨å±•å¼€** (full) | 70%å±å¹•é«˜åº¦ | æ˜¾ç¤ºå®Œæ•´å†…å®¹ | å‘ä¸Šæ‹–åŠ¨åˆ°é¡¶éƒ¨ |

### 3. è§¦æ‘¸æ‰‹åŠ¿æ§åˆ¶

- **ç‚¹å‡»Tab**ï¼šå¦‚æœæŠ½å±‰æ˜¯æ”¶èµ·çŠ¶æ€ï¼Œè‡ªåŠ¨å±•å¼€åˆ°åŠå±•å¼€çŠ¶æ€
- **æ‹–åŠ¨æŠ½å±‰å¤´éƒ¨**ï¼šå¯ä»¥è‡ªç”±è°ƒæ•´æŠ½å±‰é«˜åº¦
- **æ¾æ‰‹è‡ªåŠ¨å¸é™„**ï¼š
  - é«˜åº¦ < 150px â†’ è‡ªåŠ¨æ”¶èµ·
  - 150px â‰¤ é«˜åº¦ < (åŠå±•å¼€+å…¨å±•å¼€)/2 â†’ å¸é™„åˆ°åŠå±•å¼€
  - é«˜åº¦ â‰¥ (åŠå±•å¼€+å…¨å±•å¼€)/2 â†’ å¸é™„åˆ°å…¨å±•å¼€

### 4. ç”»å¸ƒè‡ªé€‚åº”

æŠ½å±‰é«˜åº¦å˜åŒ–æ—¶ï¼Œç”»å¸ƒä¼šè‡ªåŠ¨è°ƒæ•´å°ºå¯¸ä»¥é€‚åº”å¯ç”¨ç©ºé—´ï¼š

- **è®¡ç®—å¯ç”¨é«˜åº¦**ï¼šå±å¹•é«˜åº¦ - çŠ¶æ€æ  - å¯¼èˆªæ  - æŠ½å±‰é«˜åº¦ - è¾¹è·
- **è®¡ç®—å¯ç”¨å®½åº¦**ï¼šå±å¹•å®½åº¦ - å·¦å³è¾¹è·
- **ä¿æŒç”»å¸ƒæ¯”ä¾‹**ï¼šæ ¹æ®é€‰æ‹©çš„ç”»å¸ƒæ¯”ä¾‹ï¼ˆ1:1ã€16:9ç­‰ï¼‰è‡ªåŠ¨è®¡ç®—æœ€ä½³å°ºå¯¸
- **è‡ªåŠ¨é‡ç»˜**ï¼šå°ºå¯¸è°ƒæ•´åè‡ªåŠ¨é‡ç»˜ç”»å¸ƒå†…å®¹

### 5. æ‚¬æµ®æŒ‰é’®åŠ¨æ€å®šä½

æ‚¬æµ®æ·»åŠ å›¾ç‰‡æŒ‰é’®ï¼ˆFABï¼‰çš„ä½ç½®ä¼šæ ¹æ®æŠ½å±‰é«˜åº¦è‡ªåŠ¨è°ƒæ•´ï¼š

- **ä½ç½®è®¡ç®—**ï¼š`bottom = drawerHeight + 20px`
- **å§‹ç»ˆå¯è§**ï¼šæ— è®ºæŠ½å±‰å¤„äºä½•ç§çŠ¶æ€ï¼ŒæŒ‰é’®éƒ½ä¸ä¼šè¢«é®æŒ¡
- **å¹³æ»‘è¿‡æ¸¡**ï¼šä½¿ç”¨CSS transitionå®ç°ä½ç½®å˜åŒ–çš„å¹³æ»‘åŠ¨ç”»

---

## ğŸ¨ è®¾è®¡é£æ ¼

### è‹¹æœç®€çº¦é£æ ¼

å‚è€ƒè‹¹æœå®˜ç½‘çš„è®¾è®¡è¯­è¨€ï¼š

- **é…è‰²æ–¹æ¡ˆ**ï¼š
  - ä¸»è‰²ï¼š`#0071e3` (è‹¹æœè“)
  - æ–‡å­—ä¸»è‰²ï¼š`#1d1d1f` (æ·±ç°)
  - æ–‡å­—æ¬¡è‰²ï¼š`#86868b` (æµ…ç°)
  - èƒŒæ™¯è‰²ï¼š`#fbfbfd` (æµ…ç™½)
  - è¾¹æ¡†è‰²ï¼š`#d2d2d7` (æµ…ç°)

- **å­—ä½“è®¾è®¡**ï¼š
  - å­—å·ï¼š13px (å°å·æ–‡å­—)
  - å­—é‡ï¼š400 (å¸¸è§„) / 500 (ä¸­ç­‰) / 600 (åŠ ç²—)
  - å­—é—´è·ï¼š-0.08px (ç´§å‡‘)

- **åœ†è§’å’Œé˜´å½±**ï¼š
  - æŒ‰é’®åœ†è§’ï¼š18px (èƒ¶å›Šå½¢çŠ¶)
  - å¡ç‰‡åœ†è§’ï¼š12px
  - æ— æ˜æ˜¾é˜´å½±ï¼Œä½¿ç”¨ç»†è¾¹æ¡†

- **åŠ¨ç”»æ•ˆæœ**ï¼š
  - è¿‡æ¸¡æ—¶é—´ï¼š0.2s - 0.3s
  - ç¼“åŠ¨å‡½æ•°ï¼šease
  - ç‚¹å‡»ç¼©æ”¾ï¼šscale(0.95)

---

## ğŸ“ æ–‡ä»¶ä¿®æ”¹

### 1. `pages/collage/collage.js`

#### æ•°æ®å­—æ®µ (Line 16-34)

```javascript
// Tab ç›¸å…³
currentTab: 'template',  // å½“å‰é€‰ä¸­çš„Tab
tabs: [
  { id: 'poster', name: 'æµ·æŠ¥' },
  { id: 'template', name: 'æ¨¡ç‰ˆ' },
  { id: 'splice', name: 'æ‹¼æ¥' },
  { id: 'free', name: 'è‡ªç”±' },
  { id: 'settings', name: 'è®¾ç½®' }
],

// æŠ½å±‰çŠ¶æ€ç®¡ç†
drawerState: 'collapsed',  // 'collapsed' | 'half' | 'full'
drawerHeight: 60,  // å½“å‰æŠ½å±‰é«˜åº¦
windowHeight: 0,   // å±å¹•é«˜åº¦
showCollapseButton: false,  // æ˜¯å¦æ˜¾ç¤ºæ”¶èµ·æŒ‰é’®

// æŠ½å±‰è§¦æ‘¸ç›¸å…³
drawerTouchStartY: 0,
drawerTouchStartHeight: 0,
```

#### æ ¸å¿ƒæ–¹æ³•

**Tabåˆ‡æ¢** (Line 3350-3365)
```javascript
onTabChange(e) {
  const tabId = e.currentTarget.dataset.tabId;
  const { drawerState } = this.data;
  
  // å¦‚æœæŠ½å±‰æ˜¯æ”¶èµ·çŠ¶æ€ï¼Œç‚¹å‡»Tabæ—¶å±•å¼€åˆ°ç¬¬ä¸€å±‚
  if (drawerState === 'collapsed') {
    this.expandDrawer('half');
  }
  
  this.setData({ currentTab: tabId });
}
```

**å±•å¼€æŠ½å±‰** (Line 3369-3391)
```javascript
expandDrawer(state) {
  const { windowHeight } = this.data;
  let drawerHeight = 60;
  let showCollapseButton = false;
  
  if (state === 'half') {
    drawerHeight = 300;
    showCollapseButton = true;
  } else if (state === 'full') {
    drawerHeight = windowHeight * 0.7;
    showCollapseButton = true;
  }
  
  this.setData({
    drawerState: state,
    drawerHeight: drawerHeight,
    showCollapseButton: showCollapseButton
  }, () => {
    this.updateCanvasSizeForDrawer();
  });
}
```

**æ”¶èµ·æŠ½å±‰** (Line 3393-3402)
```javascript
collapseDrawer() {
  this.setData({
    drawerState: 'collapsed',
    drawerHeight: 60,
    showCollapseButton: false
  }, () => {
    this.updateCanvasSizeForDrawer();
  });
}
```

**è§¦æ‘¸æ‰‹åŠ¿** (Line 3404-3451)
```javascript
// è§¦æ‘¸å¼€å§‹
onDrawerTouchStart(e) {
  const touch = e.touches[0];
  this.setData({
    drawerTouchStartY: touch.clientY,
    drawerTouchStartHeight: this.data.drawerHeight
  });
}

// è§¦æ‘¸ç§»åŠ¨
onDrawerTouchMove(e) {
  const touch = e.touches[0];
  const { drawerTouchStartY, drawerTouchStartHeight, windowHeight } = this.data;
  const deltaY = drawerTouchStartY - touch.clientY; // å‘ä¸Šä¸ºæ­£
  const newHeight = drawerTouchStartHeight + deltaY;
  
  // é™åˆ¶é«˜åº¦èŒƒå›´
  const minHeight = 60;
  const maxHeight = windowHeight * 0.7;
  const clampedHeight = Math.max(minHeight, Math.min(maxHeight, newHeight));
  
  this.setData({ drawerHeight: clampedHeight });
}

// è§¦æ‘¸ç»“æŸ - è‡ªåŠ¨å¸é™„
onDrawerTouchEnd(e) {
  const { drawerHeight, windowHeight } = this.data;
  const halfHeight = 300;
  const fullHeight = windowHeight * 0.7;
  
  let targetState = 'collapsed';
  
  if (drawerHeight < 150) {
    targetState = 'collapsed';
  } else if (drawerHeight < (halfHeight + fullHeight) / 2) {
    targetState = 'half';
  } else {
    targetState = 'full';
  }
  
  this.expandDrawer(targetState);
}
```

**ç”»å¸ƒè‡ªé€‚åº”** (Line 3453-3544)
```javascript
updateCanvasSizeForDrawer() {
  // è®¡ç®—å¯ç”¨ç©ºé—´
  const availableHeight = screenHeight - topBarHeight - drawerHeight - verticalMargin;
  const availableWidth = screenWidth - horizontalMargin;
  
  // æ ¹æ®ç”»å¸ƒæ¯”ä¾‹å’Œå¯ç”¨ç©ºé—´è®¡ç®—æœ€ä½³å°ºå¯¸
  // ä¿æŒç”»å¸ƒæ¯”ä¾‹ä¸å˜ï¼Œè‡ªåŠ¨é€‚åº”å¯ç”¨ç©ºé—´
  
  // æ›´æ–°ç”»å¸ƒå°ºå¯¸å¹¶é‡ç»˜
}
```

### 2. `pages/collage/collage.wxml`

#### åº•éƒ¨æŠ½å±‰ç»“æ„ (Line 129-254)

```xml
<!-- åº•éƒ¨æŠ½å±‰åŒºåŸŸ - åŠ¨æ€é«˜åº¦ -->
<view class="bottom-drawer-area" style="height: {{drawerHeight}}px;">
  <!-- æŠ½å±‰å¤´éƒ¨ï¼šTabå¯¼èˆªæ  + æ”¶èµ·æŒ‰é’® -->
  <view class="drawer-header"
        bindtouchstart="onDrawerTouchStart"
        bindtouchmove="onDrawerTouchMove"
        bindtouchend="onDrawerTouchEnd">
    <!-- Tab å¯¼èˆªæ  -->
    <view class="tab-bar-minimal">
      <view wx:for="{{tabs}}" wx:key="id"
            class="tab-item-minimal {{currentTab === item.id ? 'active' : ''}}"
            data-tab-id="{{item.id}}"
            bindtap="onTabChange">
        <text class="tab-label">{{item.name}}</text>
      </view>
    </view>
    
    <!-- æ”¶èµ·æŒ‰é’® -->
    <view class="collapse-button" wx:if="{{showCollapseButton}}" bindtap="collapseDrawer">
      <text class="collapse-icon">â–¼</text>
    </view>
  </view>
  
  <!-- Tab å†…å®¹åŒºï¼ˆå¯æ»šåŠ¨ï¼‰ -->
  <scroll-view class="tab-content" scroll-y enhanced show-scrollbar="{{false}}">
    <!-- å„ä¸ªTabçš„å†…å®¹ -->
  </scroll-view>
</view>
```

### 3. `pages/collage/collage.wxss`

#### æ ¸å¿ƒæ ·å¼

**æŠ½å±‰å®¹å™¨** (Line 1267-1281)
```css
.bottom-drawer-area {
  background: #fbfbfd;
  display: flex;
  flex-direction: column;
  border-top: 1px solid #d2d2d7;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  transition: height 0.3s ease;
  z-index: 100;
}
```

**Tabå¯¼èˆªæ ** (Line 1289-1330)
```css
.tab-bar-minimal {
  display: flex;
  height: 44px;
  background: #fbfbfd;
  border-bottom: 1px solid #d2d2d7;
}

.tab-item-minimal.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 12px;
  right: 12px;
  height: 2px;
  background: #0071e3;
  border-radius: 1px;
}
```

**æ”¶èµ·æŒ‰é’®** (Line 1373-1395)
```css
.collapse-button {
  position: absolute;
  top: 8px;
  right: 16px;
  width: 32px;
  height: 32px;
  background: rgba(0, 0, 0, 0.05);
  border-radius: 16px;
  transition: all 0.2s;
}
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. åŸºç¡€åŠŸèƒ½æµ‹è¯•

1. **Tabåˆ‡æ¢**
   - ç‚¹å‡»ä¸åŒçš„Tabï¼Œæ£€æŸ¥æ˜¯å¦æ­£ç¡®åˆ‡æ¢
   - æ”¶èµ·çŠ¶æ€ä¸‹ç‚¹å‡»Tabï¼Œæ£€æŸ¥æ˜¯å¦è‡ªåŠ¨å±•å¼€

2. **æŠ½å±‰å±•å¼€/æ”¶èµ·**
   - ç‚¹å‡»æ”¶èµ·æŒ‰é’®ï¼Œæ£€æŸ¥æŠ½å±‰æ˜¯å¦æ”¶èµ·
   - ç‚¹å‡»Tabï¼Œæ£€æŸ¥æŠ½å±‰æ˜¯å¦å±•å¼€

3. **æ‹–åŠ¨æ‰‹åŠ¿**
   - å‘ä¸Šæ‹–åŠ¨æŠ½å±‰å¤´éƒ¨ï¼Œæ£€æŸ¥æŠ½å±‰æ˜¯å¦è·Ÿéš
   - å‘ä¸‹æ‹–åŠ¨æŠ½å±‰å¤´éƒ¨ï¼Œæ£€æŸ¥æŠ½å±‰æ˜¯å¦è·Ÿéš
   - æ¾æ‰‹åæ£€æŸ¥æ˜¯å¦è‡ªåŠ¨å¸é™„åˆ°æœ€è¿‘çš„çŠ¶æ€

### 2. ç”»å¸ƒè‡ªé€‚åº”æµ‹è¯•

1. **å±•å¼€æŠ½å±‰**
   - è§‚å¯Ÿç”»å¸ƒæ˜¯å¦è‡ªåŠ¨ç¼©å°
   - æ£€æŸ¥ç”»å¸ƒæ¯”ä¾‹æ˜¯å¦ä¿æŒä¸å˜

2. **æ”¶èµ·æŠ½å±‰**
   - è§‚å¯Ÿç”»å¸ƒæ˜¯å¦è‡ªåŠ¨æ”¾å¤§
   - æ£€æŸ¥ç”»å¸ƒæ¯”ä¾‹æ˜¯å¦ä¿æŒä¸å˜

3. **åˆ‡æ¢ç”»å¸ƒæ¯”ä¾‹**
   - åœ¨ä¸åŒæŠ½å±‰çŠ¶æ€ä¸‹åˆ‡æ¢ç”»å¸ƒæ¯”ä¾‹
   - æ£€æŸ¥ç”»å¸ƒæ˜¯å¦æ­£ç¡®è°ƒæ•´å°ºå¯¸

### 3. è¾¹ç•Œæƒ…å†µæµ‹è¯•

1. **å¿«é€Ÿæ‹–åŠ¨**
   - å¿«é€Ÿå‘ä¸Š/å‘ä¸‹æ‹–åŠ¨
   - æ£€æŸ¥æ˜¯å¦æœ‰å¡é¡¿æˆ–é”™è¯¯

2. **å¤šæ¬¡åˆ‡æ¢**
   - å¿«é€Ÿåˆ‡æ¢Tab
   - å¿«é€Ÿå±•å¼€/æ”¶èµ·æŠ½å±‰
   - æ£€æŸ¥çŠ¶æ€æ˜¯å¦æ­£ç¡®

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**
   - æŠ½å±‰é«˜åº¦å˜åŒ–ä½¿ç”¨CSS transitionï¼Œæµç•…åº¦é«˜
   - ç”»å¸ƒé‡ç»˜åªåœ¨å¿…è¦æ—¶è§¦å‘
   - ä½¿ç”¨å›è°ƒç¡®ä¿setDataå®Œæˆåå†é‡ç»˜

2. **å…¼å®¹æ€§**
   - ä½¿ç”¨å¾®ä¿¡å°ç¨‹åºåŸç”Ÿç»„ä»¶
   - è§¦æ‘¸äº‹ä»¶å…¼å®¹çœŸæœºå’Œæ¨¡æ‹Ÿå™¨
   - ç”»å¸ƒå°ºå¯¸è®¡ç®—è€ƒè™‘ä¸åŒå±å¹•å°ºå¯¸

3. **ç”¨æˆ·ä½“éªŒ**
   - è‡ªåŠ¨å¸é™„æä¾›æ˜ç¡®çš„çŠ¶æ€åé¦ˆ
   - æ”¶èµ·æŒ‰é’®åªåœ¨å±•å¼€çŠ¶æ€æ˜¾ç¤º
   - ç”»å¸ƒè‡ªé€‚åº”é¿å…å†…å®¹è¢«é®æŒ¡

---

## ğŸ”„ åç»­ä¼˜åŒ–æ–¹å‘

1. **å†…å®¹å®Œå–„**
   - å®ç°"æµ·æŠ¥"Tabçš„æ¨¡ç‰ˆé€‰æ‹©åŠŸèƒ½
   - å®ç°"æ‹¼æ¥"Tabçš„æ‹¼æ¥æ¨¡å¼
   - å®ç°"è‡ªç”±"Tabçš„è‡ªç”±ç¼–è¾‘æ¨¡å¼

2. **äº¤äº’ä¼˜åŒ–**
   - æ·»åŠ æŠ½å±‰å±•å¼€/æ”¶èµ·çš„åŠ¨ç”»æ•ˆæœ
   - ä¼˜åŒ–æ‹–åŠ¨æ‰‹åŠ¿çš„é˜»å°¼æ„Ÿ
   - æ·»åŠ è§¦è§‰åé¦ˆï¼ˆæŒ¯åŠ¨ï¼‰

3. **æ€§èƒ½ä¼˜åŒ–**
   - ä¼˜åŒ–ç”»å¸ƒé‡ç»˜æ€§èƒ½
   - æ·»åŠ é˜²æŠ–/èŠ‚æµå¤„ç†
   - ä¼˜åŒ–å†…å­˜å ç”¨

---

**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2025-11-06  
**å¼€å‘è€…**: Augment Agent

