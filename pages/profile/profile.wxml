<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-avatar">{{userInfo.avatar}}</view>
    <view class="user-info">
      <text class="user-name">{{userInfo.nickname}}</text>
      <text class="user-desc">å›¾ç‰‡æ‹¼æ¥åˆ›ä½œè€…</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ•°æ® -->
  <view class="stats-section">
    <view class="section-title">ğŸ“Š æˆ‘çš„ç»Ÿè®¡</view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{stats.totalWorks}}</text>
        <text class="stat-label">æ€»ä½œå“æ•°</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-number">{{stats.totalImages}}</text>
        <text class="stat-label">å¤„ç†å›¾ç‰‡</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-time">{{formatLastTime(stats.lastCreateTime)}}</text>
        <text class="stat-label">æœ€è¿‘åˆ›ä½œ</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½åˆ—è¡¨ -->
  <view class="features-section">
    <view class="section-title">ğŸ› ï¸ åŠŸèƒ½ä¸­å¿ƒ</view>
    
    <view class="features-list">
      <view 
        class="feature-item" 
        wx:for="{{features}}" 
        wx:key="id"
        data-feature="{{item}}"
        bindtap="onFeatureClick"
      >
        <view class="feature-icon">{{item.icon}}</view>
        
        <view class="feature-content">
          <view class="feature-header">
            <text class="feature-title">{{item.title}}</text>
            <text class="coming-soon" wx:if="{{item.comingSoon}}">å³å°†ä¸Šçº¿</text>
          </view>
          <text class="feature-subtitle">{{item.subtitle}}</text>
          <text class="feature-description">{{item.description}}</text>
        </view>
        
        <view class="feature-arrow">â†’</view>
      </view>
    </view>
  </view>

  <!-- å…¶ä»–æ“ä½œ -->
  <view class="actions-section">
    <view class="section-title">ğŸ”§ å…¶ä»–æ“ä½œ</view>
    
    <view class="action-list">
      <view class="action-item danger" bindtap="clearAllData">
        <view class="action-icon">ğŸ—‘ï¸</view>
        <view class="action-content">
          <text class="action-title">æ¸…é™¤æ•°æ®</text>
          <text class="action-desc">æ¸…é™¤æ‰€æœ‰åº”ç”¨æ•°æ®å’Œç¼“å­˜</text>
        </view>
      </view>
    </view>
  </view>
</view>

<wxs module="utils">
  var formatLastTime = function(timestamp) {
    if (!timestamp) return 'æš‚æ— è®°å½•';
    
    var date = getDate(timestamp);
    var now = getDate();
    var diff = now.getTime() - date.getTime();
    
    if (diff < 86400000) { // ä»Šå¤©
      var hours = date.getHours();
      var minutes = date.getMinutes();
      return 'ä»Šå¤© ' + (hours < 10 ? '0' + hours : hours) + ':' + (minutes < 10 ? '0' + minutes : minutes);
    } else if (diff < 172800000) { // æ˜¨å¤©
      return 'æ˜¨å¤©';
    } else {
      return date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate();
    }
  };

  module.exports.formatLastTime = formatLastTime;
</wxs>
